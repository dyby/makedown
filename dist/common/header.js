/*! Milanoo 2015-05-05 */
seajs.config({alias:{MA:pub_url+"analytics/ma.js",base:pub_url+"base/base.js",defval:pub_url+"ui/defval.js",imghover:pub_url+"ui/imghover.js",jselect:pub_url+"ui/jselect.js",jchecked:root_url+"javascript/common/jchecked.js",event:pub_url+"util/event.js","ui.form":pub_url+"ui/ui.form.js","ui.masonry":pub_url+"ui/ui.masonry.js"},charset:"utf-8"}),seajs.use("MA"),window.updateVCode=function(a,b){$(a).attr("src",root_url+"auth/captcha/?act="+b+"&"+Math.random())},define(function(a){function b(a,b){if(a.length){var c=$(a).offset().left+$(a).outerWidth(),d=$(b).offset().left+$(b).outerWidth();c>d&&$(a).css("margin-left",-1*(c-d)+"px")}}var c=a("base"),d=a("defval"),e=a("imghover"),f=a("jselect"),g=a("event"),h=a("jchecked"),i=a("ui.masonry"),j={open:function(a){var c=$(a).find(".masonry_layout"),d=$(a).find(".s-masonry")[0];c.show(),!a._masonry&&d&&(new i(d,"dl",{onFinished:function(){var a=c.find(".snav_left").length?c.find(".snav_left").outerWidth(!0):0,d=c.find(".snav_right").length?c.find(".snav_right").outerWidth(!0):0;c.css("width",a+d),b(c,"#mainmenu")}}),a._masonry=!0)},close:function(a){var b=$(a).find(".masonry_layout");b.hide()}};$(function(){$(".jchecked").each(function(){new h(this)}),f(".s_select"),$("input[defval], textarea[defval]").each(function(){new d(this)}),$(".s_goodsimg").length&&$(".s_goodsimg").each(function(){new e(this,{bgcolor:"none",opacity:1,bordercolor:"#ddd",borderwidth:"2px",borderstyle:"solid"})}),$(".lazyload").find("img").each(function(){new c.lazyload(this)}),$("#mainmenu").length&&($("#mainmenu").find("li > a:first-child").each(function(){var a=$(this).attr("cid");a&&_subnav&&_subnav[a]&&$(this).after(_subnav[a])}),g.transit($("#mainmenu").find("li"),{onOver:function(a){j.open(a)},onOut:function(a){j.close(a)}}))})}),function(a){a.extend({timeDiff:function(a,b){return new Date(b).getTime()-new Date(a).getTime()},dateToSeconds:function(a,b,c){c||(c=8);var d=new Date,e=d.getTimezoneOffset()/60,f=b?new Date(b).getTime():d.getTime(),g=new Date(a).getTime();return(g-f)/1e3-60*60*(c+e)}}),a.secondsToEndtime=function(a,b){var c=new Date,d=c.getTimezoneOffset()/60,e=c.getTime(),f=new Date(a).getTime();return(f-e)/1e3-60*60*(b+d)},a.fn.extend({timeDown:function(b){var c=this;this.each(function(){a(this).tdStop();var d={runTime:0,startDate:"",timezone:8,style:"",bindAll:!1,syncElem:null,isDays:!0,daysText:"Days",onlyDays:!1,sign:":",runBack:function(b){var e=d.sign,f="object"==typeof e&&e.length,g=f?e[0]:e,h=f?e[1]:e,i=f?e[2]:"";a(d.bindAll?c.selector:this).html((d.isDays?"<span>"+b.days+"</span> "+d.daysText+" ":"")+(d.onlyDays?"":"<span>"+b.hours+"</span>"+g+"<span>"+b.minutes+"</span>"+h+"<span>"+b.seconds+"</span>"+i))}};a.isPlainObject(b)||(d.runTime=b),a.extend(d,b),"string"==typeof d.runTime&&(d.runTime=a.dateToSeconds(d.runTime,d.startDate,d.timezone));var e=new a.td(this,d.runBack,d.syncElem,d.isDays),f=void 0==a(this).attr("style")?"":a(this).attr("style"),g=f+d.style;a(this).attr("style",g),e.init(d.runTime)})},tdStop:function(){this.each(function(){for(var b=a.td.timers.length-1;b>=0;b--)a.td.timers[b].elem===this&&a.td.timers.splice(b,1)})}}),a.td=function(a,b,c,d){this.elem=a,this.callback=b,this.isDays=d,this.syncElem=c},a.extend(a.td,{timerId:null,timers:[],tick:function(){for(var b=0,c=a.td.timers;b<c.length;b++)c[b].step();a.td.timers.length||(clearInterval(a.td.timerId),a.td.timerId=null)}}),a.td.prototype={getDefault:function(){return{days:0,hours:0,minutes:0,seconds:0}},init:function(b){this.timeMap=this.getDefault(),this.start=(new Date).getTime(),this.runTime=b,a.td.timers.push(this)&&!a.td.timerId&&(a.td.timerId=setInterval(a.td.tick,1e3),a.td.tick())},step:function(){var b=this.timeMap,c=(new Date).getTime()-this.start,d=Math.round((1e3*this.runTime-c)/1e3);a(this.elem).data("leftTime",d),this.syncElem&&a(this.syncElem).length&&(d=a(this.syncElem).data("leftTime")),d>0?(this.isDays&&(b.days=Math.floor(d/86400),d-=3600*24*b.days),b.hours=Math.floor(d/3600),b.minutes=Math.floor((d-3600*b.hours)/60),b.seconds=Math.floor(d%60)):(b=this.getDefault(),this.stop());for(var e in b)b[e]=(b[e]+"").length<2&&"days"!==e?"0"+b[e]:b[e];this.callback.call(this.elem,b)},stop:function(){for(var b=0;b<a.td.timers.length;b++)a.td.timers[b]===this&&a.td.timers.splice(b,1)}}}(jQuery);